<group name="syscheck">
  <!-- This rule detects when execute permission is added to a script. -->
  <rule id="100002" level="8">
    <if_sid>550</if_sid>
    <field name="file">\.sh$</field>
    <field name="changed_fields">^permission$</field>
    <field name="perm" type="pcre2">\w\wx</field>
    <description>Execute permission added to shell script.</description>
    <mitre>
      <id>T1222.002</id>
    </mitre>
  </rule>

  <!-- This rule detects file deletion. -->
  <rule id="100003" level="8">
    <if_sid>553</if_sid>
    <field name="process_name">explorer\.exe$</field>
    <field name="uname">USER$</field>
    <match>deleted</match>
    <description>The user "$(uname)" deleted a monitored file with File Explorer</description>
    <mitre>
      <id>T1070.004</id>
      <id>T1485</id>
    </mitre>
  </rule>
</group>
